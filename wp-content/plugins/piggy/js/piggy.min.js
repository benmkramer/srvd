var jQT=false;function getPiggyStartupImage(){if(jQuery("body.use-startup").length){return imagesUrl+"startup/startup-"+skinName+".png"}else{return""}}function playSnort(){var a=jQuery("#snort").get(0);a.play()}if(isPiggyAppleDevice()){var addToHomeConfig={animationIn:"bubble",animationOut:"fade",startDelay:400,lifespan:1000*60*24,expire:0,touchIcon:true,message:piggy_install_message}}function isPiggyAppleDevice(){return((navigator.platform=="iPhone Simulator"||navigator.platform=="iPhone"||navigator.platform=="iPod")&&typeof orientation!="undefined")}if(isPiggyAppleDevice()){var touchStartOrClick="touchstart";var touchEndOrClick="touchend"}else{var touchStartOrClick="click";var touchEndOrClick="click"}function newPurchaseCheck(){var e=new Date();var b=e.getHours();var a=e.getHours();var d=e.getMinutes();if(a>12){a=a-12}if(d<10){d="0"+d}if(b>11){var c="pm"}else{var c="am"}var f=a+":"+d+" "+c;jQuery.get(piggyWordPressURL+"/?piggy_purchase_hash=1",function(h,g,i){if(g=="error"){console.log(i.status+" "+i.statusText)}if(h!=purchaseHash){console.log("New purchase(s) found, Cleared purchase check interval. Refreshing Piggy.");refreshPiggy();purchaseHash=h}else{jQuery(".last-updated").html(piggy_last_checked+"<br/>"+f);console.log("No new purchases.")}})}var purchaseChecker="";function piggyStartInterval(){if(purchaseChecker==""){purchaseChecker=window.setInterval("newPurchaseCheck()",1000*30);console.log("Puchase check interval set (30 seconds).")}else{console.log("Puchase check interval already started.")}}function updatePaneHeight(){if(isPiggyAppleDevice()){jQuery(".scrollwrap").each(function(){var d=jQuery(window).height();var a=jQuery(".toolbar").height();if(jQuery(this).attr("id")==="home-pane"){var b=(jQuery(".filterbar").height()-10)}else{var b=0}var c=d-a-b;jQuery(this).css("height",c)})}else{jQuery(".scrollwrap").each(function(){jQuery(this).css("height","auto")})}}function setup_iScrolls(){if(isPiggyAppleDevice()){jQuery(".scrollwrap").each(function(){var a=jQuery(this).attr("id");currentScroller=new iScroll(a,{allowPropagation:true,checkDOMChanges:false,desktopCompatibility:false});jQuery(this).data("scroller",currentScroller)})}}function destroy_iScrolls(){if(isPiggyAppleDevice()){jQuery(".scrollwrap").each(function(){scroller=jQuery(this).data("scroller");delete scroller;scroller=null;jQuery(this).data("scroller","")})}}function refreshPanes(){updatePaneHeight();if(isPiggyAppleDevice()&&window.navigator.standalone){var a=jQuery(".current .scrollwrap").data("scroller");setTimeout(function(){a.refresh()},0)}}function refreshPiggy(){jQuery("#refresh").addClass("active");if(isPiggyAppleDevice()){jQuery("body").load(piggyAjaxUrl+"body > *",function(b,a,c){if(a=="error"){console.log(c.status+" "+c.statusText)}destroy_iScrolls();jQuery(document).unbind().die();delete jQT;jQT=null;jQT=new jQuery.jQTouch({slideSelector:"a.slide",submitSelector:".button-primary",cacheGetRequests:false,useFastTouch:true});doPiggyReady(false)})}else{window.location.reload()}}if(isPiggyAppleDevice()){document.addEventListener("touchmove",function(a){a.preventDefault()},false);window.addEventListener("orientationchange",function(a){refreshPanes()})}function disclosureToggles(){jQuery("li.today").bind("click",function(){jQuery(".disclosure",this).toggleClass("open");jQuery("div",this).toggle()})}function doPiggyReady(createJQT){if(createJQT){jQT=new jQuery.jQTouch({statusBar:"black",slideSelector:"a.slide",startupScreen:getPiggyStartupImage(),submitSelector:".button-primary",cacheGetRequests:false,useFastTouch:true,preloadImages:[imagesUrl+"back-buttons/"+skinName+".png",imagesUrl+"back-buttons/"+skinName+"-active.png",imagesUrl+"spinners/spinner-"+skinName+".gif",imagesUrl+"arrow.png",imagesUrl+"arrow@2x.png",imagesUrl+"piggy-metal.png"]})}jQuery(document).bind("pageAnimationEnd",function(e){jQuery(".toolbar a.back, .toolbar a.goback").removeClass("active");if(isPiggyAppleDevice()){refreshPanes()}});if(isPiggyAppleDevice()){jQuery(".toolbar h1").bind(touchStartOrClick,function(e){var currentPane=jQuery(".current .scrollwrap").data("scroller");currentPane.scrollTo(0,0,100)})}piggyStartInterval();setup_iScrolls();refreshPanes();jQuery("#refresh").bind(touchStartOrClick,function(){refreshPiggy()});disclosureToggles();jQuery('a[target="_blank"]').click(function(e){if(confirm(piggy_external_link_msg)){return true}else{jQuery(this).removeClass("active");e.preventDefault();e.stopImmediatePropagation()}});jQuery("a.logout").tap(function(e){var logoutLink=jQuery(this).attr("href");jQuery.cookie("piggy_data",null,{path:"/"});jQuery.cookie("piggy_hash",null,{path:"/"});if(isPiggyAppleDevice()){setTimeout(function(){refreshPiggy()},550)}else{setTimeout(function(){window.location.reload()},550)}e.preventDefault()});jQuery("ul.main-list li:first-child a").addClass("top-borders");jQuery("ul.main-list li:last-child a").addClass("bottom-borders");jQuery("a#info").tap(function(){playSnort()});var metalPig=jQuery("a#metal-piggy");metalPig.tap(function(){playSnort();metalPig.addClass("snort");setTimeout(function(){metalPig.removeClass("snort")},250)});jQuery("#passcode input").keyup(function(){var inputField=jQuery(this);if(inputField.val().length==passKeyNumber){var passkey=inputField.val();inputField.blur();var currentTimeout=1;jQuery.post(piggyAjaxUrl,{piggyPassKey:passkey},function(response){var jsonResponse=eval("("+response+")");if(jsonResponse.result=="pass"){if(requirePasscode){jQuery.cookie("piggy_data",jsonResponse.ip);jQuery.cookie("piggy_hash",jsonResponse.hash)}else{jQuery.cookie("piggy_data",jsonResponse.ip,{path:"/",expires:365});jQuery.cookie("piggy_hash",jsonResponse.hash,{path:"/",expires:365})}inputField.addClass("correct").val("");setTimeout(function(){jQuery("#passcode").toggleClass("ok")},330);if(isPiggyAppleDevice()){setTimeout(function(){refreshPiggy()},550)}else{setTimeout(function(){window.location.reload()},550)}}else{setTimeout(function(){inputField.addClass("incorrect");setTimeout(function(){inputField.removeClass("incorrect").val("")},1250);jQuery.cookie("piggy_data",null,{path:"/"});jQuery.cookie("piggy_hash",null,{path:"/"});currentTimeout=currentTimeout+1},currentTimeout*550)}})}});var tabContainers=jQuery("div.tab-wrap");jQuery(".filterbar li").bind(touchStartOrClick,function(e){var thisID=jQuery(this).attr("id");var thisRel=jQuery(this).attr("rel");tabContainers.hide().filter(thisRel).show();jQuery(".filterbar li").removeClass("selected");jQuery(this).addClass("selected");if(isPiggyAppleDevice()){var currentPane=jQuery(".current .scrollwrap").data("scroller");setTimeout(function(){currentPane.refresh()},100)}jQuery.cookie("piggy_tab_id",thisID,{path:"/",expires:365})});var currentTab=jQuery.cookie("piggy_tab_id");if(currentTab&&currentTab.length){jQuery("#"+currentTab).trigger(touchStartOrClick)}else{jQuery(".filterbar li:first").trigger(touchStartOrClick)}var themeSelect=jQuery("select.theme-color");themeSelect.change(function(){var selectedSkin=jQuery(this).val();if(selectedSkin){jQuery.cookie("piggy_skin",selectedSkin,{path:"/",expires:365});setTimeout(function(){alert(piggy_restart_msg)},0)}})}jQuery(document).ready(function(){doPiggyReady(true)});